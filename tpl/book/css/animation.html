<div class=page-header><h1 id=CSS>CSS 动画</h1></div><p>CSS 动画是 CSS3 加入的非常引人注目的特性了，赋予了 CSS 类似 Flash 那样通过添加关键帧来制作动画的能力。</p><h2 id=CSS>CSS 动画语法</h2><p>CSS 动画是以关键帧实现，类似 <code>transition</code>，在各个关键帧之间加上过渡，最终实现动画。</p><p>关键帧用 <code>@keyframes</code> 定义：</p><pre><code class="line-numbers language-css">@keyframes IDENT {
  0% {
    property: value1;
  }
  30% {
    property: value2;
  }
  100% {
    property: value3;
  }
}
</code></pre><p>引用动画时，非常类似过渡，包含以下属性：</p><ul><li><code>animation-name</code>：动画名称</li><li><code>animation-duration</code>：动画的持续时间</li><li><code>animation-timing-function</code>：动画的时间函数</li><li><code>animation-delay</code>：动画的开始延迟时间</li><li><code>animation-iteration-count</code>：动画的循环次数</li><li><code>animation-direction</code>：动画在循环中运动方向</li><li><code>animation-fill-mode</code>：动画之外的状态</li></ul><pre><code class="line-numbers language-css">animation: [&lt;animation-name&gt; || &lt;animation-duration&gt; || &lt;animation-timing-function&gt; || &lt;animation-delay&gt; || &lt;animation-iteration-count&gt; || &lt;animation-direction&gt;]
        [, [&lt;animation-name&gt; || &lt;animation-duration&gt; || &lt;animation-timing-function&gt; || &lt;animation-delay&gt; || &lt;animation-iteration-count&gt; || &lt;animation-direction&gt;] ]*
</code></pre><h3 id=code-animation-direction-code>动画在循环中运动方向 <code>animation-direction</code></h3><ul><li><code>normal</code>：正常方向</li><li><code>reverse</code>：反方向运行</li><li><code>alternate</code>：动画先正常运行再反方向运行，并持续交替运行* <code>alternate-reverse</code>：动画先反运行再正方向运行，并持续交替运行</li></ul><p><strong>注意</strong>：</p><ul><li>这个属性在部分浏览器部分场景有错误的行为，尽量不要使用，可以用 <code>@keyframes</code> 中的定义模拟其行为。</li></ul><h3 id=code-animation-fill-mode-code>动画之外的状态 <code>animation-fill-mode</code></h3><p>取值为以下几种：</p><ul><li><code>none</code>：默认值。不设置对象动画之外的状态</li><li><code>forwards</code>：动画之外为动画结束时的状态</li><li><code>backwards</code>：动画之外为动画开始时的状态</li><li><code>both</code>：动画前为动画开始时的状态，动画后为动画结束时的状态</li></ul><p>我们一般使用 <code>both</code>。</p><h3>编写动画</h3><p>以下是一个旋转动画，2 秒旋转一圈，动画不断循环。</p><pre><code class="line-numbers language-css">.spin {
  animation: spin 2s infinite linear;
}

@keyframes spin {
  0% {
    transform: rotate(0);
  }
  100% {
    transform: rotate(360deg);
  }
}
</code></pre><h2 id=CSS-Performance>高性能 CSS 动画（Performance）</h2><p>CSS 动画性能是需要我们注意的，使用不当会造成动画卡顿、CPU 占用率高等问题。比如注意避免触发回流（Reflow）、在 <code>absolute</code> 或 <code>fixed</code> 定位的元素上使用动画等。</p><ul><li><a href="https://www.w3.org/2015/Talks/0109-CSSConf-xq/">吴小倩（W3C）：CSS 性能</a></li><li><a href="http://melonh.com/sharing/slides.html?file=high_performance_animation#/1">黄薇（360奇舞团）：高性能 CSS 动画</a></li><li><a href="https://www.qianduan.net/high-performance-css3-animations/">神飞（腾讯）：高性能 CSS3 动画</a></li><li><a href="http://www.zhangxinxu.com/wordpress/2015/11/css3-will-change-improve-paint/">张鑫旭（腾讯）：使用 CSS3 will-change 提高页面滚动、动画等渲染性能</a></li></ul><h2 id=CSS>练习（石英钟 - CSS 动画）</h2><p>我们本次为石英钟添加动画的部分，让我们的石英钟真正走起来。</p><h3>所有指针的走动</h3><p>定义一个旋转动画，用于使指针走动。</p><pre><code class="line-numbers language-stylus">@keyframes spin
  0%
    transform: rotate(0)
  100%
    transform: rotate(360deg)
</code></pre><p>先统一制定动画名称、线性变化、无限循环，再依次对不同指针指定动画时长。</p><pre><code class="line-numbers language-stylus">.inner
  animation: spin 1s linear infinite

#hour
  .inner
    animation-duration: 60s * 60 * 12

#minute
  .inner
    animation-duration: 60s * 60
</code></pre><p>秒针比较特殊，它是一秒一步走动的，因此我们指定为 <code>steps(60)</code></p><pre><code class="line-numbers language-stylus">#second
  .inner
    animation-duration: 60s
    animation-timing-function: steps(60)
</code></pre><h3>秒针的震颤</h3><p>再定义一个震颤动画，用于模拟石英钟秒针走动时的震颤效果。</p><pre><code class="line-numbers language-stylus">@keyframes tiktoc
  0%
  100%
    transform: rotate(0)
  8%
    transform: rotate(1deg)
  16%
    transform: rotate(-1deg)
</code></pre><p>这个动画每秒执行，无限循环。</p><pre><code class="line-numbers language-stylus">#second
  .outer
    animation: tiktoc 1s infinite
</code></pre><p>这样就实现了以下效果：</p><p><style>#clock,#clock-1,#clock-2,#second .outer-2,.hand,.mark-hour,.mark-hour .mark-minute-1-1,.mark-hour .mark-minute-1-2,.mark-hour .mark-minute-2-1,.mark-hour .mark-minute-2-2,.mark-hour-1,.pane{position:absolute;top:50%;left:50%}#container{position:absolute;top:0;bottom:0;left:0;right:0;background:#232425;background:-webkit-radial-gradient(#636669,#19191a);background:-moz-radial-gradient(#636669,#19191a);background:-o-radial-gradient(#636669,#19191a);background:-ms-radial-gradient(#636669,#19191a);background:radial-gradient(#636669,#19191a);-webkit-background-size:cover;-moz-background-size:cover;background-size:cover;font:14px/1.4 Helvetica,Arial,sans-serif}#clock{width:26em;height:26em;margin:-13em 0 0 -13em;background:#f9f9f9;background:-webkit-linear-gradient(top,#f9f9f9,#666);background:-moz-linear-gradient(top,#f9f9f9,#666);background:-o-linear-gradient(top,#f9f9f9,#666);background:-ms-linear-gradient(top,#f9f9f9,#666);background:linear-gradient(to bottom,#f9f9f9,#666);-webkit-border-radius:2em;border-radius:2em;-webkit-box-shadow:.3em .5em 2em #333,inset 0 0 2em rgba(221,221,221,.4),inset 0 -.2em .2em rgba(0,0,0,.3);box-shadow:.3em .5em 2em #333,inset 0 0 2em rgba(221,221,221,.4),inset 0 -.2em .2em rgba(0,0,0,.3)}#clock-1{width:24em;height:24em;margin:-12em 0 0 -12em;background:-webkit-linear-gradient(310deg,#f6f8f9 0,#e5ebee 50%,#cdd4d9 51%,#f5f7f9 100%);background:-moz-linear-gradient(310deg,#f6f8f9 0,#e5ebee 50%,#cdd4d9 51%,#f5f7f9 100%);background:-o-linear-gradient(310deg,#f6f8f9 0,#e5ebee 50%,#cdd4d9 51%,#f5f7f9 100%);background:-ms-linear-gradient(310deg,#f6f8f9 0,#e5ebee 50%,#cdd4d9 51%,#f5f7f9 100%);background:linear-gradient(140deg,#f6f8f9 0,#e5ebee 50%,#cdd4d9 51%,#f5f7f9 100%);-webkit-background-size:cover;-moz-background-size:cover;background-size:cover;-webkit-border-radius:12em;border-radius:12em;-webkit-box-shadow:.1em .3em 1em rgba(51,51,51,.2);box-shadow:.1em .3em 1em rgba(51,51,51,.2)}#clock-2{width:23em;height:23em;margin:-11.5em 0 0 -11.5em;background:-webkit-linear-gradient(top,#fff,#ccc);background:-moz-linear-gradient(top,#fff,#ccc);background:-o-linear-gradient(top,#fff,#ccc);background:-ms-linear-gradient(top,#fff,#ccc);background:linear-gradient(to bottom,#fff,#ccc);border:.1em solid rgba(0,0,0,.2);-webkit-border-radius:12.5em;border-radius:12.5em;-webkit-box-shadow:inset rgba(0,0,0,.2) .2em .2em 1em,inset 12em 14em 0 -10em rgba(255,255,255,.3);box-shadow:inset rgba(0,0,0,.2) .2em .2em 1em,inset 12em 14em 0 -10em rgba(255,255,255,.3)}.pane{z-index:3;width:16em;height:16em;margin:-8em 0 0 -8em}.inner,.outer{width:100%;height:100%}.hand{-webkit-box-shadow:rgba(0,0,0,.8) 0 0 .2em;box-shadow:rgba(0,0,0,.8) 0 0 .2em}#hour .hand{width:.6em;height:4em;margin:-4em -.3em 0;-webkit-border-radius:.5em .5em 0 0/4em 4em 0 0;border-radius:.5em .5em 0 0/4em 4em 0 0;background:#333}#minute .hand{width:.3em;height:7em;margin:-7em -.15em 0;-webkit-border-radius:.5em .5em 0 0/7em 7em 0 0;border-radius:.5em .5em 0 0/7em 7em 0 0;background:#333}#second .outer-2{width:1em;height:1em;margin:-.5em 0 0 -.5em;background:#c00;-webkit-border-radius:1em;border-radius:1em;-webkit-box-shadow:rgba(0,0,0,.8) 0 0 .2em;box-shadow:rgba(0,0,0,.8) 0 0 .2em}#second .hand{width:.2em;height:11em;margin:-11em -.1em 0;-webkit-border-radius:.5em .5em 0 0/11em 11em 0 0;border-radius:.5em .5em 0 0/11em 11em 0 0;background:#c00;margin-top:-9em}#hour{-webkit-transform:rotate(30deg);transform:rotate(30deg)}#minute{-webkit-transform:rotate(160deg);transform:rotate(160deg)}#second{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.mark-hour{width:4em;height:20em;margin:-10em 0 0 -2em;text-align:center;z-index:2}.mark-hour-1{width:.2em;height:.5em;margin:-.25em 0 0 -.1em;text-align:center;-webkit-box-shadow:0 -10.5em #777,0 10.5em #777;box-shadow:0 -10.5em #777,0 10.5em #777;z-index:2}.mark-hour .mark-minute-1-1,.mark-hour .mark-minute-1-2,.mark-hour .mark-minute-2-1,.mark-hour .mark-minute-2-2{width:.2em;height:.2em;margin:-.1em 0 0 -.1em;-webkit-box-shadow:0 -10.5em #777,0 10.5em #777;box-shadow:0 -10.5em #777,0 10.5em #777;z-index:2}.mark-hour .mark-minute-1-1{-webkit-transform:rotate(6deg);-moz-transform:rotate(6deg);-o-transform:rotate(6deg);-ms-transform:rotate(6deg);transform:rotate(6deg)}.mark-hour .mark-minute-1-2{-webkit-transform:rotate(-6deg);-moz-transform:rotate(-6deg);-o-transform:rotate(-6deg);-ms-transform:rotate(-6deg);transform:rotate(-6deg)}.mark-hour .mark-minute-2-1{-webkit-transform:rotate(12deg);-moz-transform:rotate(12deg);-o-transform:rotate(12deg);-ms-transform:rotate(12deg);transform:rotate(12deg)}.mark-hour .mark-minute-2-2{-webkit-transform:rotate(-12deg);-moz-transform:rotate(-12deg);-o-transform:rotate(-12deg);-ms-transform:rotate(-12deg);transform:rotate(-12deg)}.mark-hour .text-bottom,.mark-hour .text-top{line-height:2em;font-size:1.5em;color:#445;text-shadow:#667 0 .05em .1em}.mark-hour .text-bottom{margin:9.333333333333334em 0 0}#mark-hour-1{-webkit-transform:rotate(29.99999999999988deg);-moz-transform:rotate(29.99999999999988deg);-o-transform:rotate(29.99999999999988deg);-ms-transform:rotate(29.99999999999988deg);transform:rotate(29.99999999999988deg)}#mark-hour-1 .text-bottom,#mark-hour-1 .text-top{-webkit-transform:rotate(-29.99999999999988deg);-moz-transform:rotate(-29.99999999999988deg);-o-transform:rotate(-29.99999999999988deg);-ms-transform:rotate(-29.99999999999988deg);transform:rotate(-29.99999999999988deg)}#mark-hour-2{-webkit-transform:rotate(60.000000000000114deg);-moz-transform:rotate(60.000000000000114deg);-o-transform:rotate(60.000000000000114deg);-ms-transform:rotate(60.000000000000114deg);transform:rotate(60.000000000000114deg)}#mark-hour-2 .text-bottom,#mark-hour-2 .text-top{-webkit-transform:rotate(-60.000000000000114deg);-moz-transform:rotate(-60.000000000000114deg);-o-transform:rotate(-60.000000000000114deg);-ms-transform:rotate(-60.000000000000114deg);transform:rotate(-60.000000000000114deg)}#mark-hour-3{-webkit-transform:rotate(90deg);-moz-transform:rotate(90deg);-o-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}#mark-hour-3 .text-bottom,#mark-hour-3 .text-top{-webkit-transform:rotate(-90deg);-moz-transform:rotate(-90deg);-o-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg)}#mark-hour-4{-webkit-transform:rotate(119.99999999999987deg);-moz-transform:rotate(119.99999999999987deg);-o-transform:rotate(119.99999999999987deg);-ms-transform:rotate(119.99999999999987deg);transform:rotate(119.99999999999987deg)}#mark-hour-4 .text-bottom,#mark-hour-4 .text-top{-webkit-transform:rotate(-119.99999999999987deg);-moz-transform:rotate(-119.99999999999987deg);-o-transform:rotate(-119.99999999999987deg);-ms-transform:rotate(-119.99999999999987deg);transform:rotate(-119.99999999999987deg)}#mark-hour-5{-webkit-transform:rotate(150.0000000000001deg);-moz-transform:rotate(150.0000000000001deg);-o-transform:rotate(150.0000000000001deg);-ms-transform:rotate(150.0000000000001deg);transform:rotate(150.0000000000001deg)}#mark-hour-5 .text-bottom,#mark-hour-5 .text-top{-webkit-transform:rotate(-150.0000000000001deg);-moz-transform:rotate(-150.0000000000001deg);-o-transform:rotate(-150.0000000000001deg);-ms-transform:rotate(-150.0000000000001deg);transform:rotate(-150.0000000000001deg)}#mark-hour-6{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-o-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}#mark-hour-6 .text-bottom,#mark-hour-6 .text-top{-webkit-transform:rotate(-180deg);-moz-transform:rotate(-180deg);-o-transform:rotate(-180deg);-ms-transform:rotate(-180deg);transform:rotate(-180deg)}#clock .inner{-webkit-animation:spin 1s linear infinite;-moz-animation:spin 1s linear infinite;-o-animation:spin 1s linear infinite;-ms-animation:spin 1s linear infinite;animation:spin 1s linear infinite}#hour .inner{-webkit-animation-duration:43200s;-moz-animation-duration:43200s;-o-animation-duration:43200s;-ms-animation-duration:43200s;animation-duration:43200s}#minute .inner{-webkit-animation-duration:3600s;-moz-animation-duration:3600s;-o-animation-duration:3600s;-ms-animation-duration:3600s;animation-duration:3600s}#second .inner{-webkit-animation-duration:60s;-moz-animation-duration:60s;-o-animation-duration:60s;-ms-animation-duration:60s;animation-duration:60s;-webkit-animation-timing-function:steps(60);-moz-animation-timing-function:steps(60);-o-animation-timing-function:steps(60);-ms-animation-timing-function:steps(60);animation-timing-function:steps(60)}#second .outer{-webkit-animation:tiktoc 1s infinite;-moz-animation:tiktoc 1s infinite;-o-animation:tiktoc 1s infinite;-ms-animation:tiktoc 1s infinite;animation:tiktoc 1s infinite}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0);-moz-transform:rotate(0);-o-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0);-moz-transform:rotate(0);-o-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes tiktoc{0%,100%{-webkit-transform:rotate(0);-moz-transform:rotate(0);-o-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0)}8%{-webkit-transform:rotate(1deg);-moz-transform:rotate(1deg);-o-transform:rotate(1deg);-ms-transform:rotate(1deg);transform:rotate(1deg)}16%{-webkit-transform:rotate(-1deg);-moz-transform:rotate(-1deg);-o-transform:rotate(-1deg);-ms-transform:rotate(-1deg);transform:rotate(-1deg)}}@keyframes tiktoc{0%,100%{-webkit-transform:rotate(0);-moz-transform:rotate(0);-o-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0)}8%{-webkit-transform:rotate(1deg);-moz-transform:rotate(1deg);-o-transform:rotate(1deg);-ms-transform:rotate(1deg);transform:rotate(1deg)}16%{-webkit-transform:rotate(-1deg);-moz-transform:rotate(-1deg);-o-transform:rotate(-1deg);-ms-transform:rotate(-1deg);transform:rotate(-1deg)}}</style></p><div style=position:relative;width:100%;height:500px><div id=container><div id=clock><div id=clock-1></div><div id=mark-hour-1 class=mark-hour><div class=mark-hour-1></div><div class=mark-minute-1><div class=mark-minute-1-1></div><div class=mark-minute-1-2></div></div><div class=mark-minute-2><div class=mark-minute-2-1></div><div class=mark-minute-2-2></div></div><div class=text-top>1</div><div class=text-bottom>7</div></div><div id=mark-hour-2 class=mark-hour><div class=mark-hour-1></div><div class=mark-minute-1><div class=mark-minute-1-1></div><div class=mark-minute-1-2></div></div><div class=mark-minute-2><div class=mark-minute-2-1></div><div class=mark-minute-2-2></div></div><div class=text-top>2</div><div class=text-bottom>8</div></div><div id=mark-hour-3 class=mark-hour><div class=mark-hour-1></div><div class=mark-minute-1><div class=mark-minute-1-1></div><div class=mark-minute-1-2></div></div><div class=mark-minute-2><div class=mark-minute-2-1></div><div class=mark-minute-2-2></div></div><div class=text-top>3</div><div class=text-bottom>9</div></div><div id=mark-hour-4 class=mark-hour><div class=mark-hour-1></div><div class=mark-minute-1><div class=mark-minute-1-1></div><div class=mark-minute-1-2></div></div><div class=mark-minute-2><div class=mark-minute-2-1></div><div class=mark-minute-2-2></div></div><div class=text-top>4</div><div class=text-bottom>10</div></div><div id=mark-hour-5 class=mark-hour><div class=mark-hour-1></div><div class=mark-minute-1><div class=mark-minute-1-1></div><div class=mark-minute-1-2></div></div><div class=mark-minute-2><div class=mark-minute-2-1></div><div class=mark-minute-2-2></div></div><div class=text-top>5</div><div class=text-bottom>11</div></div><div id=mark-hour-6 class=mark-hour><div class=mark-hour-1></div><div class=mark-minute-1><div class=mark-minute-1-1></div><div class=mark-minute-1-2></div></div><div class=mark-minute-2><div class=mark-minute-2-1></div><div class=mark-minute-2-2></div></div><div class=text-top>6</div><div class=text-bottom>12</div></div><div id=hour class=pane><div class=outer><div class=inner><div class=hand></div></div></div></div><div id=minute class=pane><div class=outer><div class=inner><div class=hand></div></div></div></div><div id=second class=pane><div class=outer><div class=inner><div class=hand></div></div><div class=outer-2></div></div></div><div id=clock-2></div></div></div></div><h3>指针初始为当前系统时间</h3><p>进一步地，我们可以用 JavaScript 获取当前系统时间，为指针设置初始位置。</p><p>至此我们的石英钟全部完成，最终的效果：</p><iframe height=500 scrolling=no src="//codepen.io/Cweili/embed/QwgZGy/?height=500&theme-id=11611&default-tab=result" frameborder=no allowtransparency=true allowfullscreen=true style=width:100%></iframe><h3>本次完整代码</h3><p>Jade</p><pre><code class="line-numbers language-jade">mixin hand(unit)
  .pane(id=unit)
    .outer
      .inner
        .hand

#container
  #clock
    - for (var i = 1; i &lt;= 6; i++)
      .mark-hour(id=&#39;mark-hour-&#39; + i)
        .mark-minute-1
        .mark-minute-2
        .text-top= i
        .text-bottom= i + 6

    each unit in [&#39;hour&#39;, &#39;minute&#39;, &#39;second&#39;]
      +hand(unit)
</code></pre><p>Stylus</p><pre><code class="line-numbers language-stylus">@import &quot;nib&quot;

$absolute-center
  absolute: top 50% left 50%

rectangle-center(width, height = width)
  width: width
  height: height
  margin: (height / -2) 0 0 (width / -2)
  @extend $absolute-center

hand(width, height, color)
  width: width
  height: height
  margin: - height (width / -2) 0
  border-radius: .5em .5em 0 0/height height 0 0
  background: color

#container
  absolute: top 0 bottom 0 left 0 right 0
  background: #232425
  background: radial-gradient(@background + 30%, @background - 30%)
  background-size: cover
  font: 14px/1.4 &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif
  @media (max-width: 768px)
    font-size: 12px

#clock
  rectangle-center: 26em
  background: linear-gradient(to bottom, #f9f9f9, #666)
  border-radius: 2em
  box-shadow: .3em .5em 2em #333, inset 0 0 2em rgba(#ddd, .4),
              inset 0 -.2em .2em rgba(#000, .3)
  &amp;::before
    content: &quot;&quot;
    rectangle-center: 24em
    background: linear-gradient(140deg, #f6f8f9 0%, #e5ebee 50%, #cdd4d9 51%, #f5f7f9 100%)
    background-size: cover
    border-radius: 12em
    box-shadow: .1em .3em 1em rgba(#333, .2)
  &amp;::after
    content: &quot;&quot;
    rectangle-center: 23em
    background: linear-gradient(to bottom, #fff, #ccc)
    border: .1em solid rgba(#000, .2)
    border-radius: 12.5em
    box-shadow: inset rgba(#000, .2) .2em .2em 1em,
                inset 12em 14em 0 -10em rgba(#fff, .3)

.mark-hour
  $mark-color = #777
  $mark-height-total = 20em
  $mark-height-text = 2em
  $mark-length = .5em
  $mark-size-text = 1.5em
  $mark-deg-min = 6deg
  rectangle-center: 4em $mark-height-total
  text-align: center
  z-index: 2
  &amp;::before
    content: &quot;&quot;
    rectangle-center: .2em $mark-length
    text-align: center
    box-shadow: 0 ($mark-height-total / -2) - $mark-length $mark-color,
                0 ($mark-height-total / 2) + $mark-length $mark-color
    z-index: 2
  .mark-minute
    &amp;-1
    &amp;-2
      &amp;::before
      &amp;::after
        content: &quot;&quot;
        rectangle-center: .2em
        box-shadow: 0 ($mark-height-total / -2) - $mark-length $mark-color,
                    0 ($mark-height-total / 2) + $mark-length $mark-color
        z-index: 2
    &amp;-1
      &amp;::before
        transform: rotate($mark-deg-min)
      &amp;::after
        transform: rotate(- $mark-deg-min)
    &amp;-2
      &amp;::before
        transform: rotate($mark-deg-min * 2)
      &amp;::after
        transform: rotate($mark-deg-min * -2)
  .text-top
  .text-bottom
    line-height: $mark-height-text
    font-size: 1.5em
    color: #445
    text-shadow: #667 0 .05em .1em
  .text-bottom
    margin: (($mark-height-total - ($mark-height-text * $mark-size-text * 2)) / $mark-size-text) 0 0

for hour in 1..6
  #mark-hour-{hour}
    transform: rotate((hour / 12) * 360deg)
    .text-top
    .text-bottom
      transform: rotate((hour / 12) * -360deg)

.pane
  z-index: 3
  rectangle-center: 16em

.outer
.inner
  width: 100%
  height: 100%

.inner
  animation: spin 1s linear infinite

.hand
  box-shadow: rgba(#000, .8) 0 0 .2em
  @extend $absolute-center

#hour
  .inner
    animation-duration: 60s * 60 * 12
  .hand
    hand: .6em 4em #333

#minute
  .inner
    animation-duration: 60s * 60
  .hand
    hand: .3em 7em #333

#second
  $color = #c00
  .inner
    animation-duration: 60s
    animation-timing-function: steps(60)
  .outer
    animation: tiktoc 1s infinite
    &amp;::after
      content: &quot;&quot;
      rectangle-center: 1em
      background: $color
      border-radius: 1em
      box-shadow: rgba(#000, .8) 0 0 .2em
  .hand
    hand: .2em 11em $color
    margin-top: -9em

@keyframes spin
  0%
    transform: rotate(0)
  100%
    transform: rotate(360deg)

@keyframes tiktoc
  0%
  100%
    transform: rotate(0)
  8%
    transform: rotate(1deg)
  16%
    transform: rotate(-1deg)
</code></pre><p>CoffeeScript</p><pre><code class="line-numbers language-coffeescript">now = new Date()
time = (now.getTime() - Date.parse &quot;#{now}&quot;.replace /(\d{2}:){2}\d{2}/, &#39;00:00:00&#39;) // 1000
model =
  second: (time % 60) / 60
  minute: ((time / 60) % 60) / 60
  hour: ((time / 60 / 60) % 12) / 12

for unit, time of model
  hand = window[unit]
  deg = time * 360
  hand.style[&quot;#{vendor}transform&quot;] = &quot;rotate(#{deg}deg)&quot; for vendor in [
    &#39;-webkit-&#39;
    &#39;-moz-&#39;
    &#39;-ms-&#39;
    &#39;-o-&#39;
    &#39;&#39;
  ]
</code></pre>